---
import Layout from "@/components/layout/Layout.astro"
import ArticleListView from "@/components/views/ArticleListView.astro"
import { PAGE_NAME } from "@/constants/page"
import { getArticlesWithPagination, getTotalArticlePageCount } from "@/services/api"
import { transformDataToArticleInfo } from "@/utils/transformer"

const totalArticlePageCount = await getTotalArticlePageCount()
const articles = await getArticlesWithPagination(1)
const articleInfoList = await Promise.all(
  articles.map(article => transformDataToArticleInfo(article, "smaller"))
)
---

<Layout title={PAGE_NAME.TOP}>
  <ArticleListView
    articleInfoList={articleInfoList}
    currentPage={1}
    totalPageCount={totalArticlePageCount}
    useCase="list"
  />
</Layout>
